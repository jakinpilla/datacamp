ch021
================
Daniel\_Kim
2019 12 15

``` r
load('unemp.RData')
```

``` r
summary(unemployment)
```

    ##  male_unemployment female_unemployment  predictions   
    ##  Min.   :2.900     Min.   :4.000       Min.   :3.448  
    ##  1st Qu.:4.900     1st Qu.:4.400       1st Qu.:4.837  
    ##  Median :6.000     Median :5.200       Median :5.601  
    ##  Mean   :5.954     Mean   :5.569       Mean   :5.569  
    ##  3rd Qu.:6.700     3rd Qu.:6.100       3rd Qu.:6.087  
    ##  Max.   :9.800     Max.   :7.900       Max.   :8.240

``` r
summary(unemployee_model)
```

    ## 
    ## Call:
    ## lm(formula = female_unemployment ~ male_unemployment, data = unemployment)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -0.77621 -0.34050 -0.09004  0.27911  1.31254 
    ## 
    ## Coefficients:
    ##                   Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)        1.43411    0.60340   2.377   0.0367 *  
    ## male_unemployment  0.69453    0.09767   7.111 1.97e-05 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.5803 on 11 degrees of freedom
    ## Multiple R-squared:  0.8213, Adjusted R-squared:  0.8051 
    ## F-statistic: 50.56 on 1 and 11 DF,  p-value: 1.966e-05

Make predictions from the model

``` r
unemployment$predictions <- predict(unemployee_model, data = unemployment)
```

Fill in the blanks to plot predictions (on x-axis) versus the
female\_unemployment rates

``` r
ggplot(unemployment, aes(x = predictions, y = female_unemployment)) + 
  geom_point() + 
  geom_abline()
```

![](ch002_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

Calculate residuals

``` r
unemployment$residuals <- unemployment$female_unemployment - unemployment$predictions
```

To plot predictions (on x-axis) versus the residuals with
`geom_pointrange()`

``` r
ggplot(unemployment, aes(x = predictions, y = residuals)) + 
  geom_pointrange(aes(ymin = 0, ymax = residuals)) + 
  geom_hline(yintercept = 0, linetype = 3) + 
  ggtitle("residuals vs. linear model prediction")
```

![](ch002_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->

``` r
summary(unemployment)
```

    ##  male_unemployment female_unemployment  predictions      residuals       
    ##  Min.   :2.900     Min.   :4.000       Min.   :3.448   Min.   :-0.77621  
    ##  1st Qu.:4.900     1st Qu.:4.400       1st Qu.:4.837   1st Qu.:-0.34050  
    ##  Median :6.000     Median :5.200       Median :5.601   Median :-0.09004  
    ##  Mean   :5.954     Mean   :5.569       Mean   :5.569   Mean   : 0.00000  
    ##  3rd Qu.:6.700     3rd Qu.:6.100       3rd Qu.:6.087   3rd Qu.: 0.27911  
    ##  Max.   :9.800     Max.   :7.900       Max.   :8.240   Max.   : 1.31254

unemployment\_model is in the workspace

``` r
summary(unemployee_model)
```

    ## 
    ## Call:
    ## lm(formula = female_unemployment ~ male_unemployment, data = unemployment)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -0.77621 -0.34050 -0.09004  0.27911  1.31254 
    ## 
    ## Coefficients:
    ##                   Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)        1.43411    0.60340   2.377   0.0367 *  
    ## male_unemployment  0.69453    0.09767   7.111 1.97e-05 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.5803 on 11 degrees of freedom
    ## Multiple R-squared:  0.8213, Adjusted R-squared:  0.8051 
    ## F-statistic: 50.56 on 1 and 11 DF,  p-value: 1.966e-05

Load the package WVPlots

``` r
# install.packages('WVPlots')
library(WVPlots)
```

    ## Warning: package 'WVPlots' was built under R version 3.5.3

Plot the Gain Curve

``` r
GainCurvePlot(unemployment, 'predictions', 'female_unemployment', "Unemployment model")
```

![](ch002_files/figure-gfm/unnamed-chunk-10-1.png)<!-- -->

When the predictions sort in exactly the same order, the relative Gini
coefficient is 1. When the model sorts poorly, the relative Gini
coefficient is close to zero, or even negative.

### RMSE

For convenience put the residuals in the variable res

``` r
res <- unemployment$residuals
```

Calculate RMSE, assign it to the variable rmse and print it

``` r
(rmse <- sqrt(mean(res^2)))
```

    ## [1] 0.5337612

Calculate the standard deviation of female\_unemployment and print it

``` r
(sd_unemployment <- sd(unemployment$female_unemployment))
```

    ## [1] 1.314271
