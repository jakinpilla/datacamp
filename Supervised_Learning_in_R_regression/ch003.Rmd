---
title: "ch003"
author: "Daniel_Kim"
date: '2019 12 15 '
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gdata)
library(broom)
# install.packages('sigr')
library(sigr)
```


### Catogorical Variables...

 Call str on flowers to see the types of each column

```{r, message = FALSE}
# install.packages('Sleuth3')
library(Sleuth3)
```

```{r, message = FALSE}
flowers <- case0901
flowers %>%
  mutate(Time = ifelse(Time == 1, "Late", "Early")) -> flowers
flowers %>% head
```


Use unique() to see how many possible values Time takes

```{r}
unique(flowers$Time)
```


 Build a formula to express Flowers as a function of Intensity and Time: fmla. Print it
 
```{r}
(fmla <- as.formula("Flowers ~ Intensity + Time"))
```
 
Use fmla and model.matrix to see how the data is represented for modeling

```{r}
mmat <- model.matrix(fmla, flowers)
mmat
```


 Examine the first 20 lines of flowers
 
```{r}
head(flowers, 20)
```
 

 Examine the first 20 lines of mmat

```{r}
head(mmat, 20)
```


Fit a model to predict Flowers from Intensity and Time : flower_model

```{r}
flower_model <- lm(fmla, data= flowers)
```

Use summary on mmat to remind yourself of its structure

```{r}
summary(mmat)
```

Use summary to examine flower_model 

```{r}
summary(flower_model)
```


Predict the number of flowers on each plant

```{r}
flowers$predictions <- predict(flower_model, flowers)
```


Plot predictions vs actual flowers (predictions on x-axis)

```{r}
ggplot(flowers, aes(x = predictions, y = Flowers)) + 
  geom_point() +
  geom_abline(color = "blue") 
```

### Interactions

Data alcohol loading...

```{r}
# str(case1101)
alcohol <- case1101
str(alcohol)
```

```{r}
summary(alcohol)
```


Create the formula with main effects only
Gastric : 위, Metabol : 물질대사

```{r}
(fmla_add <- Metabol ~ Gastric + Sex)
```

Create the formula with interactions

```{r}
(fmla_interaction <- Metabol ~ Gastric + Sex + Gastric:Sex)
```

Fit the main effects only model

```{r}
model_add <- lm(fmla_add, data = alcohol)
```

Fit the interaction model

```{r}
model_interaction <- lm(fmla_interaction, data =  alcohol)
```

Call summary on both models and compare

```{r}
summary(model_add)
```


```{r}
summary(model_interaction)
```

